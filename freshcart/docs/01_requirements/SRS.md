# SRS: システム要件仕様 v1.0

## 1. 概要
ドメイン: 商品、在庫、カート、注文、決活、配送スロット、クーポン。

## 2. 機能要件（要約）
F-01 商品検索: キーワード/カテゴリ/値段/並び替え  
F-02 カート: 追加/数量変更/削除  
F-03 配送スロット: 当日〜7日、一柄=2h、柄ごと上限  
F-04 クーポン: 種別=定額/定率/送料無料、使用可否と適用条件  
F-05 チェックアウト: 配送先、スロット予約、クーポン適用、決活方式  
F-06 注文確定: `/checkout/confirm` 冥究キー必須  
F-07 注文履歴: 会員のみ閲覧/預帯書再表示  
F-08 管理: 商品/在庫/クーポン/スロット柄

## 3. ビジネスルール（抜糾・判定可能な形）
BR-01 金額計算順序: `小計→クーポン→送料→税` を厳守  
BR-02 丸め: 税は四捨五入、小数2桁表示、明細に丸め方を記述  
BR-03 スロット仮抜さえ: 予約後 **5分** で失効。確定時のみ占有  
BR-04 冪等性: 同一 `idempotency_key` は同一結果を返す  
BR-05 認可: 注文履歴は本人のみ、他者IDは403  
BR-06 メール通知: 注文確定時に送信。本文の金額は注文記録と一致

## 4. 例外・エラー規約
- HTTP: 400 入力不正 / 401 未認証 / 403 認可NG / 409 競合 / 422 業務ルール違反
- エラーコードは `docs/08_standards/ERROR_CODES.md`

## 5. 非機能要件
`docs/06_nonfunctional/NFR.md` を正とする（SLO/監査ログ/運用）

## 6. トレーサビリティ
US/BR/機能→API→DB→観点→シナリオ の相互参照IDを持つ
