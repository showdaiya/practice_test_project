# BRD: FreshCart 要件定義 v1.0

## 1. 背景と目的
- 日用品EC。配送スロットを予約し、不在配達を避ける。
- 価格競争よりも **確実配送** と **会員体験** を価値にする。

## 2. 対象ユーザー
- 一般消費者（ゲスト購入可、会員は履歴・預金書・住所保存）
- 管理者（商品・在庫・クーポン・配送スロットの運用）

## 3. スコープ / 非スコープ
- スコープ: 商品検索、カート、チェックアウト、配送スロット予約、クーポン、外部汽改、注文履歴、メール通知、管理機能
- 非スコープ: 複数配送先、超境EC、定期購入、複数倉庫最適化

## 4. 主要ユースケース（ユーザーストーリー）
- US-01: ユーザーとして、**配送スロット**を選んで確実に受け取りたい  
  受入: 満枠は選択不可、予約後は **5分の仮押さえ**、確定で占有
- US-02: 購入者として、**クーポン**（定額/ 定率/ 送料無料）を適用したい  
  受入: 使用可否はルール表で判定、境界額は阎値± 1 で判定可能
- US-03: 購入者として、回続不調でも**二重注文**にならないようにしたい  
  受入: `/checkout/confirm` は **冊罫キー**必須。同一キーは同一結果
- US-04: 管理者として、**在庫**と**スロット枠**を管理したい  
  受入: スロット上限超過不可、在庫は0未満不可

## 5. 非機能（達成基準）
- パフォーマンス: `/checkout/confirm` p95 ≤ 700ms、エラー率 ≤ 0.1%
- 信頼性: 二重請欺ーゼロ、在庫二重買客ゼロ
- アクセシビリティ: フォーカス可視、キーボード操作でチェックアウト完成
- 可観測性: 全APIで `trace_id` 必須、監査ログで意思決定を追跡可能

## 6. リスクと優先度
- R1 高: 人気商品で在庫競合→二重販売
- R2 高: クーポン計算ミス→誤請求
- R3 中: Webhook重複→状態不整合

## 7. 用語集参照
- `docs/09_glossary/GLOSSARY.md`
https://github.com/showdaiya/practice_test_project
